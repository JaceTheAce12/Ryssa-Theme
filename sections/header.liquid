{%- comment -%}
  ----------------------------------------------------------------------------------
  RYSSA HEADER - Custom Implementation
  Includes: HTML Structure, Schema Settings, CSS Design System, and Interactivity JS
  - Fix: Corrected Hamburger "X" animation alignment
  - Fix: Prevents logo overlap on small screens
  ----------------------------------------------------------------------------------
{%- endcomment -%}

<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap');
</style>

<header 
  class="site-header" 
  data-section-id="{{ section.id }}" 
  id="SiteHeader"
>
  <div class="site-header__inner">
    
    <button class="site-header__menu-toggle" aria-label="Open menu" aria-expanded="false" aria-controls="mobile-nav">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <a href="{{ routes.root_url }}" class="site-header__logo" aria-label="{{ shop.name }}">
      {%- if section.settings.logo != blank -%}
        {%- assign logo_alt = section.settings.logo.alt | default: shop.name | escape -%}
        {{ section.settings.logo | image_url: width: section.settings.logo_width | image_tag: 
          class: 'site-header__logo-image',
          widths: '50, 100, 150, 200, 250, 300, 400, 500',
          height: 'auto',
          alt: logo_alt
        }}
      {%- else -%}
        <svg width="120" height="32" viewBox="0 0 120 32" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
          <text x="0" y="24" font-family="Playfair Display, serif" font-size="24" font-weight="300" fill="currentColor">RYSSA</text>
        </svg>
      {%- endif -%}
    </a>

    <nav class="site-header__nav" aria-label="Primary navigation">
      <ul class="site-header__menu">
        {%- for link in linklists[section.settings.menu].links -%}
          <li>
            <a href="{{ link.url }}" class="{% if link.active %}active{% endif %}">
              {{ link.title }}
            </a>
          </li>
        {%- endfor -%}
      </ul>
    </nav>

    <div class="site-header__actions">
      
      {%- if section.settings.show_search -%}
        <a href="{{ routes.search_url }}" class="site-header__action-btn" aria-label="Search">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor">
            <circle cx="9" cy="9" r="6" stroke-width="1.5"/>
            <path d="M13.5 13.5L17 17" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </a>
      {%- endif -%}

      {%- if shop.customer_accounts_enabled -%}
        <a href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.account_login_url }}{% endif %}" class="site-header__action-btn" aria-label="Account">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor">
            <circle cx="10" cy="7" r="3.5" stroke-width="1.5"/>
            <path d="M4 17C4 13.6863 6.68629 11 10 11C13.3137 11 16 13.6863 16 17" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </a>
      {%- endif -%}

      <a href="{{ routes.cart_url }}" class="site-header__action-btn site-header__cart" aria-label="Cart">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor">
          <path d="M3 3H4.5L6.5 13H16.5L18.5 6H6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="7.5" cy="16.5" r="1" fill="currentColor"/>
          <circle cx="15.5" cy="16.5" r="1" fill="currentColor"/>
        </svg>
        {%- if cart.item_count > 0 -%}
          <span class="cart-count">{{ cart.item_count }}</span>
        {%- endif -%}
      </a>
    </div>
  </div>
</header>

<div class="mobile-nav-overlay" id="mobile-nav" aria-hidden="true">
  <nav class="mobile-nav" aria-label="Mobile navigation">
    <ul class="mobile-nav__menu">
      {%- for link in linklists[section.settings.menu].links -%}
        <li><a href="{{ link.url }}">{{ link.title }}</a></li>
      {%- endfor -%}
    </ul>
  </nav>
</div>

{% schema %}
{
  "name": "Ryssa Header",
  "settings": [
    {
      "type": "header",
      "content": "Logo"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo Image"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 50,
      "max": 300,
      "step": 10,
      "default": 120,
      "unit": "px",
      "label": "Logo Width"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Main Menu"
    },
    {
      "type": "header",
      "content": "Options"
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "default": true,
      "label": "Show Search Icon"
    }
  ]
}
{% endschema %}

{% stylesheet %}
  /* ========================================
     CSS CUSTOM PROPERTIES
     ======================================== */

  :root {
    /* Colors - Neutrals */
    --color-white: #FFFFFF;
    --color-cloud: #F8F6F3;
    --color-sand: #E3DAC9;
    --color-taupe: #CAB9A9;
    --color-mocha: #A89788;
    --color-charcoal: #3A3632;
    --color-black: #1A1A1A;

    /* Colors - Accent */
    --color-accent-primary: #8B7355;
    --color-accent-secondary: #2C3E50;

    /* Colors - Primary Accent (Pale Blue) */
    --color-primary: #e9f5ff;
    --color-primary-hover: #d4ecff;
    --color-primary-dark: #c0e3ff;

    /* Colors - Semantic */
    --color-text-primary: var(--color-black);
    --color-text-secondary: #525252;
    --color-background-primary: var(--color-white);
    --color-background-secondary: var(--color-cloud);

    /* Typography - Fonts */
    --font-display: 'Playfair Display', Georgia, serif;
    --font-body: 'Inter', 'Helvetica Neue', Arial, sans-serif;

    /* Typography - Type Scale */
    --text-base: 1rem;      /* 16px */
    --text-lg: 1.25rem;     /* 20px */
    --text-xl: 1.563rem;    /* 25px */
    --text-2xl: 1.953rem;   /* 31.25px */
    --text-3xl: 2.441rem;   /* 39px */
    --text-4xl: 3.052rem;   /* 48.83px */
    --text-5xl: 3.815rem;   /* 61.04px */

    /* Typography - Font Weights */
    --font-light: 300;
    --font-regular: 400;
    --font-medium: 500;
    --font-semibold: 600;

    /* Typography - Line Heights */
    --leading-tight: 1.2;
    --leading-normal: 1.5;
    --leading-relaxed: 1.6;

    /* Typography - Letter Spacing */
    --tracking-tight: -0.02em;
    --tracking-normal: 0;
    --tracking-wide: 0.1em;
    --tracking-wider: 0.15em;

    /* Layout - Grid System */
    --grid-columns: 12;
    --grid-gap: 24px;
    --content-max-width: 1440px;

    /* Layout - Spacing */
    --spacing-xs: 8px;
    --spacing-sm: 16px;
    --spacing-md: 24px;
    --spacing-lg: 32px;
    --spacing-xl: 48px;
    --spacing-2xl: 80px;
    --spacing-3xl: 120px;
    --spacing-4xl: 160px;

    /* Animation - Easing */
    --ease-smooth: cubic-bezier(0.16, 1, 0.3, 1);
    --ease-default: ease;

    /* Animation - Duration */
    --duration-fast: 150ms;
    --duration-base: 300ms;
    --duration-slow: 600ms;

    /* Shadows */
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.12);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.15);

    /* Border Radius */
    --radius-sm: 2px;
    --radius-md: 4px;
    --radius-lg: 8px;

    /* Border Colors */
    --color-border-light: #E8E8E8;
    --color-border-subtle: rgba(0, 0, 0, 0.08);
  }


  /* ========================================
     CSS RESET & BASE STYLES
     ======================================== */

  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  html {
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  body {
    font-family: var(--font-body);
    font-size: var(--text-base);
    font-weight: var(--font-regular);
    line-height: var(--leading-relaxed);
    color: var(--color-text-primary);
    background-color: var(--color-background-primary);
    overflow-x: hidden;
  }

  img,
  picture,
  video,
  canvas,
  svg {
    display: block;
    max-width: 100%;
  }

  img {
    height: auto;
  }

  button,
  input,
  textarea,
  select {
    font: inherit;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  ul,
  ol {
    list-style: none;
  }

  button {
    background: none;
    border: none;
    cursor: pointer;
  }


  /* ========================================
     TYPOGRAPHY
     ======================================== */

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: var(--font-display);
    font-weight: var(--font-light);
    line-height: var(--leading-tight);
    letter-spacing: var(--tracking-tight);
    margin-bottom: 0.5em;
  }

  h1 {
    font-size: clamp(2.5rem, 6vw, var(--text-5xl));
  }

  h2 {
    font-size: clamp(2rem, 4vw, var(--text-4xl));
  }

  h3 {
    font-size: var(--text-2xl);
    font-weight: var(--font-medium);
    letter-spacing: var(--tracking-normal);
  }

  h4 {
    font-size: var(--text-lg);
    font-weight: var(--font-medium);
  }

  p {
    margin-bottom: 1em;
  }

  p:last-child {
    margin-bottom: 0;
  }

  .eyebrow {
    display: block;
    font-family: var(--font-body);
    font-size: 11px;
    font-weight: var(--font-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-sm);
    transition: color var(--duration-fast) var(--ease-default);
  }

  .fade-in.visible .eyebrow {
    color: var(--color-accent-primary);
  }


  /* ========================================
     LAYOUT UTILITIES
     ======================================== */

  .container {
    width: 100%;
    max-width: var(--content-max-width);
    margin: 0 auto;
    padding: 0 var(--spacing-md);
  }

  .section {
    padding-block: clamp(var(--spacing-2xl), 12vw, var(--spacing-4xl));
  }

  .section-header {
    text-align: center;
    margin-bottom: var(--spacing-2xl);
  }

  .section-title {
    font-weight: var(--font-regular);
  }


  /* ========================================
     SITE HEADER
     ======================================== */

  .site-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    background-color: var(--color-white);
    border-bottom: 1px solid var(--color-border-light);
    transition: transform var(--duration-base) var(--ease-default);
  }

  .site-header--hidden {
    transform: translateY(-100%);
  }

  .site-header__inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 80px;
    max-width: var(--content-max-width);
    margin: 0 auto;
    padding: 0 var(--spacing-md);
  }

  .site-header__logo svg {
    display: block;
    color: var(--color-black);
    transition: opacity var(--duration-fast) var(--ease-default);
  }

  .site-header__logo:hover svg {
    opacity: 0.7;
  }

  /* Desktop Navigation */
  .site-header__nav {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
  }

  .site-header__menu {
    display: flex;
    gap: var(--spacing-xl);
  }

  .site-header__menu a {
    font-size: 14px;
    font-weight: var(--font-medium);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
    transition: color var(--duration-fast) var(--ease-default);
    position: relative;
  }

  .site-header__menu a::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 2px;
    background-color: var(--color-primary-hover);
    transition: width var(--duration-base) var(--ease-smooth);
  }

  .site-header__menu a:hover,
  .site-header__menu a.active {
    color: var(--color-accent-primary);
  }

  .site-header__menu a:hover::after,
  .site-header__menu a.active::after {
    width: 100%;
  }

  .site-header__menu a:active {
    color: var(--color-charcoal);
  }

  /* Mobile Menu Toggle */
  .site-header__menu-toggle {
    display: none;
    flex-direction: column;
    gap: 5px;
    padding: 8px;
    min-width: 44px;
    min-height: 44px;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 10;
  }

  .site-header__menu-toggle span {
    display: block;
    width: 24px;
    height: 2px;
    background-color: var(--color-black);
    transition: all var(--duration-base) var(--ease-smooth);
  }

  /* --- FIXED X ANIMATION --- */
  /* Top bar: Move down to center, THEN rotate */
  .site-header__menu-toggle[aria-expanded="true"] span:nth-child(1) {
    transform: translateY(7px) rotate(45deg);
  }

  /* Middle bar: Fade out */
  .site-header__menu-toggle[aria-expanded="true"] span:nth-child(2) {
    opacity: 0;
  }

  /* Bottom bar: Move up to center, THEN rotate */
  .site-header__menu-toggle[aria-expanded="true"] span:nth-child(3) {
    transform: translateY(-7px) rotate(-45deg);
  }

  /* Header Actions */
  .site-header__actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
  }

  .site-header__action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 44px;
    min-height: 44px;
    color: var(--color-black);
    transition: opacity var(--duration-fast) var(--ease-default);
  }

  .site-header__action-btn:hover {
    opacity: 0.6;
  }

  .site-header__action-btn:active {
    opacity: 0.4;
  }

  .site-header__action-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  .site-header__cart {
    position: relative;
  }

  .cart-count {
    position: absolute;
    top: var(--spacing-xs);
    right: var(--spacing-xs);
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 18px;
    height: 18px;
    padding: 0 4px;
    font-size: 10px;
    font-weight: var(--font-semibold);
    color: var(--color-white);
    background-color: var(--color-black);
    border-radius: 50%;
    line-height: 1;
  }

  /* Mobile Navigation Overlay */
  .mobile-nav-overlay {
    position: fixed;
    top: 80px;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--color-white);
    z-index: 999;
    opacity: 0;
    visibility: hidden;
    transition: opacity var(--duration-base) var(--ease-default),
              visibility var(--duration-base) var(--ease-default);
  }

  .mobile-nav-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  .mobile-nav {
    padding: var(--spacing-xl) var(--spacing-md);
  }

  .mobile-nav__menu {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
  }

  .mobile-nav__menu a {
    font-size: var(--text-xl);
    font-family: var(--font-display);
    font-weight: var(--font-light);
    letter-spacing: var(--tracking-tight);
    padding: var(--spacing-sm) 0;
    border-bottom: 1px solid var(--color-border-subtle);
    transition: color var(--duration-fast) var(--ease-default),
              background-color var(--duration-fast) var(--ease-default);
  }

  .mobile-nav__menu a:hover,
  .mobile-nav__menu a:focus-visible {
    color: var(--color-accent-primary);
    background-color: rgba(139, 115, 85, 0.08);
  }

  .mobile-nav__menu a:active {
    background-color: rgba(139, 115, 85, 0.15);
  }

  /* ========================================
     RESPONSIVE BREAKPOINTS
     ======================================== */

  /* Tablet (768px) */
  @media (max-width: 768px) {
    .container {
      padding: 0 var(--spacing-md);
    }

    /* Header */
    .site-header__nav {
      display: none;
    }

    .site-header__menu-toggle {
      display: flex;
    }

    .site-header__logo {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      max-width: 50%; /* Prevent overlapping */
      display: flex;
      justify-content: center;
      z-index: 1;
    }
    
    .site-header__logo img,
    .site-header__logo svg {
      max-width: 100%;
      height: auto;
    }

    .site-header__actions {
      gap: 8px; /* Tighter gap on tablet/mobile */
      position: relative;
      z-index: 10;
    }
  }

  /* Small Mobile (<400px) Fix */
  @media (max-width: 400px) {
    .site-header__logo {
      max-width: 100px; /* Force smaller logo to prevent overlap */
    }
    .site-header__actions {
      gap: 4px; /* Extra tight gap */
    }
  }
{% endstylesheet %}

<script>
/**
 * Magazine-Style Fashion Landing Page
 * Main JavaScript - Vanilla JS Implementation
 */

(function() {
  'use strict';

  /* ========================================
     HEADER SCROLL BEHAVIOR
     ======================================== */
  class HeaderScroll {
    constructor() {
      this.header = document.querySelector('.site-header');
      this.lastScrollY = window.scrollY;
      this.ticking = false;
      if (this.header) { this.init(); }
    }

    init() {
      window.addEventListener('scroll', () => {
        if (!this.ticking) {
          window.requestAnimationFrame(() => {
            this.handleScroll();
            this.ticking = false;
          });
          this.ticking = true;
        }
      }, { passive: true });
    }

    handleScroll() {
      if (!this.header) return;
      const currentScrollY = window.scrollY;
      if (currentScrollY > this.lastScrollY && currentScrollY > 100) {
        this.header.classList.add('site-header--hidden');
      } else {
        this.header.classList.remove('site-header--hidden');
      }
      this.lastScrollY = currentScrollY;
    }
  }

  /* ========================================
     MOBILE MENU TOGGLE
     ======================================== */
  class MobileMenu {
    constructor() {
      this.toggle = document.querySelector('.site-header__menu-toggle');
      this.overlay = document.querySelector('.mobile-nav-overlay');
      this.body = document.body;
      this.scrollbarWidth = 0;
      this.isOpen = false;
      if (this.toggle && this.overlay) {
        this.scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;
        this.init();
      }
    }

    init() {
      this.toggle.addEventListener('click', () => this.toggleMenu());
      const menuLinks = this.overlay.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', () => this.closeMenu());
      });
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && this.isOpen) {
          this.closeMenu();
          this.toggle.focus();
        }
      });
    }

    toggleMenu() {
      if (this.isOpen) { this.closeMenu(); } else { this.openMenu(); }
    }

    openMenu() {
      this.overlay.classList.add('active');
      this.overlay.setAttribute('aria-hidden', 'false');
      this.toggle.setAttribute('aria-expanded', 'true');
      this.toggle.setAttribute('aria-label', 'Close menu');
      this.body.style.overflow = 'hidden';
      this.body.style.paddingRight = `${this.scrollbarWidth}px`;
      this.isOpen = true;
      const firstLink = this.overlay.querySelector('a');
      if (firstLink) { firstLink.focus(); }
    }

    closeMenu() {
      this.overlay.classList.remove('active');
      this.overlay.setAttribute('aria-hidden', 'true');
      this.toggle.setAttribute('aria-expanded', 'false');
      this.toggle.setAttribute('aria-label', 'Open menu');
      this.body.style.overflow = '';
      this.body.style.paddingRight = '';
      this.isOpen = false;
    }
  }

  /* ========================================
     INITIALIZE
     ======================================== */
  function init() {
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializeModules);
    } else {
      initializeModules();
    }
  }

  function initializeModules() {
    try {
      new HeaderScroll();
      new MobileMenu();
    } catch (error) {
      console.warn('Header JS Error:', error);
    }
  }

  init();
})();
</script>